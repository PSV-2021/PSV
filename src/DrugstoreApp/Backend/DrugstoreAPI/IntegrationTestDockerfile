FROM mcr.microsoft.com/dotnet/core/sdk:3.1 as build-env
WORKDIR /src
COPY DrugstoreAPI.sln ./
COPY Drugstore/*.csproj ./Drugstore/
COPY DrugstoreAPI/*.csproj ./DrugstoreAPI/
COPY DrugstoreApiTests/*.csproj ./DrugstoreApiTests/
RUN dotnet restore DrugstoreAPI.sln

COPY . ./

WORKDIR /src/DrugstoreApiTests
RUN dotnet test --filter Type=IntegrationTest --no-restore